<!DOCTYPE html>
<html lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>זיהוי דיבור בלייב</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin-top: 50px;
        }
        #transcript {
            font-size: 24px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>זיהוי דיבור בלייב</h1>
    <button id="startButton">התחל להקליט</button>
    <div id="transcript"></div>

    <script>
        const startButton = document.getElementById('startButton');
        const transcriptDiv = document.getElementById('transcript');
        let recognition;

        // פונקציה להפעיל את זיהוי הדיבור
        function startSpeechRecognition() {
            // בדיקה אם Web Speech API נתמך בדפדפן
            if (!('webkitSpeechRecognition' in window)) {
                alert("הדפדפן שלך לא תומך בזיהוי דיבור");
                return;
            }

            // יצירת אובייקט זיהוי הדיבור
            recognition = new webkitSpeechRecognition();
            recognition.lang = 'he-IL'; // הגדרת השפה לעברית
            recognition.continuous = true; // מאפשר זיהוי דיבור רצוף
            recognition.interimResults = true; // מציג תוצאות בזמן אמת

            // הפונקציה שתופסת את התוצאות של זיהוי הדיבור
            recognition.onresult = function(event) {
                let transcript = '';
                for (let i = event.resultIndex; i < event.results.length; i++) {
                    transcript += event.results[i][0].transcript;
                }
                transcriptDiv.textContent = transcript;
            };

            // התחל את הזיהוי
            recognition.start();
        }

        // בקשת אישור להקלטה
        startButton.addEventListener('click', function() {
            if (navigator.permissions) {
                navigator.permissions.query({ name: 'microphone' }).then(function(result) {
                    if (result.state === 'granted') {
                        startSpeechRecognition();
                    } else {
                        alert('עליך לאשר גישה למיקרופון');
                    }
                });
            } else {
                alert('הדפדפן שלך לא תומך בבקשות אישור גישה');
                startSpeechRecognition();
            }
        });
    </script>
</body>
</html>
